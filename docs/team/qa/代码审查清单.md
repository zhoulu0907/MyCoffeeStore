# MyCoffeeStore 代码审查清单

> 版本：1.0
> 创建时间：2026-02-26
> 审查范围：前端 + 后端 + 架构

---

## 使用说明

本清单用于 MyCoffeeStore 项目的代码审查流程。审查时请：

1. 逐项检查，标记通过/不通过
2. 对于不通过项，记录问题描述和改进建议
3. 按优先级分类问题（P0-严重/P1-重要/P2-一般）
4. 跟踪问题直到解决

---

## 1. 架构审查

### 1.1 接口设计合理性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **RESTful 规范** | 仅使用 GET/POST 方法（项目规范） | [ ] | |
| **接口命名** | 使用 kebab-case，语义清晰 | [ ] | |
| **请求方法** | GET 用于查询，POST 用于写操作 | [ ] | |
| **响应格式** | 统一使用 `Result<T>` 格式 | [ ] | |
| **错误码规范** | 使用标准 HTTP 状态码 | [ ] | |
| **版本控制** | 接口路径包含版本号（如 /api/v1/） | [ ] | |
| **幂等性** | 写操作保证幂等性 | [ ] | |

### 1.2 数据库设计规范性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **表命名** | snake_case，小写，见名知意 | [ ] | |
| **字段命名** | snake_case，统一风格 | [ ] | |
| **主键设计** | 使用自增 Long 类型主键 `id` | [ ] | |
| **索引设计** | 查询字段有适当索引 | [ ] | |
| **外键约束** | 关联字段建立外键 | [ ] | |
| **字段类型** | 类型选择合理（如价格用 DECIMAL） | [ ] | |
| **时间字段** | 统一使用 DATETIME，有默认值 | [ ] | |
| **软删除** | 重要表包含 `deleted` 字段 | [ ] | |
| **字符集** | 统一使用 UTF-8 | [ ] | |

### 1.3 系统安全性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **认证机制** | 使用 JWT 进行身份认证 | [ ] | |
| **密码加密** | 使用 BCrypt 等安全加密 | [ ] | |
| **SQL 注入防护** | 使用参数化查询 | [ ] | |
| **XSS 防护** | 前端输入已转义 | [ ] | |
| **CSRF 防护** | 实施 CSRF Token 验证 | [ ] | |
| **敏感数据** | 不在日志中输出敏感信息 | [ ] | |
| **API 限流** | 实施接口限流保护 | [ ] | |
| **HTTPS** | 生产环境强制 HTTPS | [ ] | |

### 1.4 性能设计

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **分页查询** | 列表接口支持分页 | [ ] | |
| **缓存策略** | 热点数据有缓存 | [ ] | |
| **N+1 查询** | 避免 N+1 查询问题 | [ ] | |
| **数据库连接池** | 配置合理 | [ ] | |
| **异步处理** | 耗时操作使用异步 | [ ] | |

---

## 2. 前端审查

### 2.1 组件设计合理性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **函数式组件** | 仅使用函数式组件 | [ ] | |
| **组件拆分** | 组件职责单一，可复用 | [ ] | |
| **Props 类型** | 使用 TypeScript 定义完整 | [ ] | |
| **默认值** | Props 有合理的默认值 | [ ] | |
| **组件命名** | PascalCase，语义清晰 | [ ] | |
| **文件组织** | 按功能分类，结构清晰 | [ ] | |
| **样式隔离** | 组件样式不影响全局 | [ ] | |

### 2.2 状态管理正确性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **本地状态** | 简单状态使用 useState | [ ] | |
| **Context 使用** | 跨组件状态使用 Context | [ ] | |
| **状态更新** | 状态更新不可变 | [ ] | |
| **副作用处理** | useEffect 依赖完整 | [ ] | |
| **状态派生** | 使用 useMemo 缓存计算结果 | [ ] | |
| **回调函数** | 使用 useCallback 稳定引用 | [ ] | |

### 2.3 性能优化

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **React.memo** | 组件适当使用 memo | [ ] | |
| **代码分割** | 使用懒加载减少初始包大小 | [ ] | |
| **图片优化** | 图片使用压缩和懒加载 | [ ] | |
| **列表渲染** | 列表使用稳定 key | [ ] | |
| **防抖节流** | 搜索/滚动事件使用防抖节流 | [ ] | |
| **包大小** | 生产包大小合理 | [ ] | |

### 2.4 TypeScript 类型

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **禁止 any** | 不使用 any 类型 | [ ] | |
| **接口定义** | 所有数据结构有类型定义 | [ ] | |
| **类型导出** | 类型统一导出 | [ ] | |
| **泛型使用** | 复用逻辑使用泛型 | [ ] | |
| **枚举使用** | 固定值使用枚举 | [ ] | |

### 2.5 响应式适配

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **断点设计** | 包含移动端、平板、桌面 | [ ] | |
| **弹性布局** | 使用 Flex/Grid 布局 | [ ] | |
| **移动端测试** | 在移动设备上测试 | [ ] | |
| **触摸操作** | 移动端交互友好 | [ ] | |

### 2.6 用户体验

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **加载状态** | 异步操作有加载提示 | [ ] | |
| **错误处理** | 错误信息友好展示 | [ ] | |
| **空状态** | 列表为空有提示 | [ ] | |
| **表单验证** | 实时验证，错误提示清晰 | [ ] | |
| **操作反馈** | 操作成功有反馈 | [ ] | |
| **路由导航** | 页面切换流畅 | [ ] | |

---

## 3. 后端审查

### 3.1 API 实现正确性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **参数校验** | 使用 @Valid 校验参数 | [ ] | |
| **异常处理** | 异常被正确捕获和处理 | [ ] | |
| **返回数据** | 返回格式统一 | [ ] | |
| **空指针** | 正确处理 null 值 | [ ] | |
| **边界条件** | 处理边界情况 | [ ] | |

### 3.2 数据库操作安全性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **SQL 注入** | 使用参数化查询 | [ ] | |
| **事务管理** | 写操作使用事务 | [ ] | |
| **连接泄漏** | 连接正确关闭 | [ ] | |
| **批量操作** | 大批量操作分批处理 | [ ] | |
| **乐观锁** | 并发更新使用乐观锁 | [ ] | |

### 3.3 异常处理完整性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **全局异常** | 有全局异常处理器 | [ ] | |
| **业务异常** | 使用业务异常类 | [ ] | |
| **异常日志** | 异常有详细日志 | [ ] | |
| **用户提示** | 用户看到友好的错误信息 | [ ] | |
| **错误码** | 使用规范错误码 | [ ] | |

### 3.4 事务处理正确性

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **事务边界** | 事务范围合理 | [ ] | |
| **回滚策略** | 明确回滚条件 | [ ] | |
| **只读事务** | 查询使用只读事务 | [ ] | |
| **事务传播** | 正确设置传播级别 | [ ] | |

### 3.5 日志规范

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **日志级别** | 正确使用日志级别 | [ ] | |
| **关键操作** | 关键操作有日志 | [ ] | |
| **异常日志** | 异常包含堆栈信息 | [ ] | |
| **敏感信息** | 日志不包含敏感信息 | [ ] | |
| **日志格式** | 日志格式统一 | [ ] | |

### 3.6 代码组织

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **分层清晰** | Controller-Service-Mapper 分层 | [ ] | |
| **单一职责** | 类方法职责单一 | [ ] | |
| **依赖注入** | 使用构造器注入 | [ ] | |
| **循环依赖** | 无循环依赖 | [ ] | |
| **包结构** | 包结构合理 | [ ] | |

---

## 4. 测试审查

### 4.1 单元测试

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **覆盖率** | 核心业务覆盖率 > 70% | [ ] | |
| **测试用例** | 测试用例全面 | [ ] | |
| **断言完整** | 断言验证关键行为 | [ ] | |
| **测试隔离** | 测试之间无依赖 | [ ] | |
| **Mock 使用** | 正确使用 Mock | [ ] | |

### 4.2 集成测试

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **API 测试** | 主要 API 有集成测试 | [ ] | |
| **数据库测试** | 使用测试数据库 | [ ] | |
| **测试数据** | 测试数据准备充分 | [ ] | |
| **清理机制** | 测试后数据清理 | [ ] | |

---

## 5. 代码风格

### 5.1 通用风格

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **命名规范** | 遵循项目命名规范 | [ ] | |
| **注释完整** | 公开 API 有注释 | [ ] | |
| **代码格式** | 通过格式化检查 | [ ] | |
| **魔法值** | 无魔法数字/字符串 | [ ] | |
| **代码重复** | 无明显重复代码 | [ ] | |
| **复杂度** | 圈复杂度合理 | [ ] | |

### 5.2 前端风格

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **ESLint** | 无 ESLint 错误 | [ ] | |
| **Prettier** | 代码格式一致 | [ ] | |
| **组件顺序** | 组件内元素顺序一致 | [ ] | |
| **导入顺序** | Import 导入有序 | [ ] | |

### 5.3 后端风格

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **Checkstyle** | 无 Checkstyle 错误 | [ ] | |
| **Lombok** | 合理使用 Lombok | [ ] | |
| **JavaDoc** | 公开类/方法有 JavaDoc | [ ] | |
| **异常注解** | 方法抛出异常有 @throws | [ ] | |

---

## 6. 文档审查

### 6.1 代码文档

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **README** | 项目有完整的 README | [ ] | |
| **API 文档** | API 有 Swagger 文档 | [ ] | |
| **数据库文档** | 数据库设计有文档 | [ ] | |
| **变更日志** | 重要变更有记录 | [ ] | |

### 6.2 注释质量

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **复杂逻辑** | 复杂逻辑有注释 | [ ] | |
| **TODO 标记** | TODO 有问题描述 | [ ] | |
| **过时注释** | 无过时/错误注释 | [ ] | |

---

## 7. 安全审查

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **输入验证** | 所有用户输入已验证 | [ ] | |
| **输出编码** | 输出数据正确编码 | [ ] | |
| **认证授权** | 接口有认证授权 | [ ] | |
| **敏感数据** | 敏感数据加密存储 | [ ] | |
| **依赖安全** | 第三方依赖无已知漏洞 | [ ] | |
| **配置安全** | 配置文件不包含密钥 | [ ] | |

---

## 8. 性能审查

### 8.1 前端性能

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **加载时间** | 首屏加载 < 2秒 | [ ] | |
| **包大小** | JS 包大小合理 | [ ] | |
| **资源优化** | 图片/字体已优化 | [ ] | |
| **渲染性能** | 无明显卡顿 | [ ] | |

### 8.2 后端性能

| 检查项 | 标准 | 通过 | 问题记录 |
|--------|------|------|----------|
| **响应时间** | API 响应 < 500ms (P95) | [ ] | |
| **数据库查询** | 无慢查询 | [ ] | |
| **缓存使用** | 热点数据有缓存 | [ ] | |
| **并发处理** | 支持预期并发量 | [ ] | |

---

## 9. 问题记录模板

### 问题描述

```markdown
### 问题编号：QAXXX-001

**严重程度**：P0 / P1 / P2
**审查人**：XXX
**审查日期**：2026-XX-XX
**相关文件**：文件路径

**问题描述**：
（详细描述发现的问题）

**影响范围**：
（说明问题影响的范围）

**改进建议**：
（提供具体的改进建议）

**优先级**：
- [ ] 立即修复（P0）
- [ ] 本轮修复（P1）
- [ ] 下轮修复（P2）

**状态**：
- [ ] 待修复
- [ ] 修复中
- [ ] 待验证
- [ ] 已关闭
```

---

## 10. 审查总结模板

```markdown
# 代码审查报告

**审查日期**：2026-XX-XX
**审查范围**：XXX 模块 / XXX 提交
**审查人**：XXX

## 审查统计

- 检查项总数：XX
- 通过项数：XX
- 不通过项数：XX
- 通过率：XX%

## 问题汇总

### P0 级问题（严重）
1. QAXXX-001：XXX

### P1 级问题（重要）
1. QAXXX-002：XXX
2. QAXXX-003：XXX

### P2 级问题（一般）
1. QAXXX-004：XXX

## 审查结论

[ ] 通过 - 可以合并
[ ] 有条件通过 - 修复 P0/P1 问题后可合并
[ ] 不通过 - 需要重大修改

## 备注

（其他需要说明的事项）
```

---

*文档版本：1.0*
*最后更新：2026-02-26*
